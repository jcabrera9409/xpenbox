# =====================================================================
# Application Properties
# =====================================================================

# Server Configuration
# ---------------------------------------------------------------------

# Application Name
quarkus.application.name=xpenbox-back

# HTTP Port Configuration
%dev.quarkus.http.port=8080
%prod.quarkus.http.port=${PORT:8080}

# Set the application path
quarkus.http.root-path=/api/rest/v1

# Database Configuration
# ---------------------------------------------------------------------

# Kind of Database
quarkus.datasource.db-kind=mariadb

# JDBC URL for Database Connection
quarkus.datasource.jdbc.url=${DATASOURCE_URL:jdbc:mariadb://localhost:3306/xpenbox_db}

# Credentials for Database Connection
quarkus.datasource.username=${DATASOURCE_USERNAME:root}
quarkus.datasource.password=${DATASOURCE_PASSWORD:root}

# Connection Pool Configuration
quarkus.datasource.jdbc.min-size=2
quarkus.datasource.jdbc.max-size=10

# Hibernate ORM Configuration
# ---------------------------------------------------------------------

# Hibernate DDL Generation Strategy
quarkus.hibernate-orm.database.generation=validate

# Hibernate logging of SQL statements in development mode
%dev.quarkus.hibernate-orm.log.sql=true

# CORS Configuration
# ---------------------------------------------------------------------

# Enable CORS
quarkus.http.cors=true

# CORS for development mode
%dev.quarkus.http.cors.origins=${CORS_ALLOWED_ORIGINS:http://localhost:4200,http://127.0.0.1:4200}
%dev.quarkus.http.cors.headers=accept,authorization,content-type,x-requested-with
%dev.quarkus.http.cors.methods=GET,POST,PUT,PATCH,DELETE
%dev.quarkus.http.cors.exposed-headers=*

# CORS for production mode
%prod.quarkus.http.cors.origins=${CORS_ALLOWED_ORIGINS}
%prod.quarkus.http.cors.headers=accept,authorization,content-type
%prod.quarkus.http.cors.methods=GET,POST,PUT,PATCH,DELETE
%prod.quarkus.http.cors.exposed-headers=authorization,content-type

# JWT Configuration
# ---------------------------------------------------------------------

# JWT Key Locations
mp.jwt.verify.publickey.location=${JWT_PUBLIC_KEY_PATH}
smallrye.jwt.sign.key.location=${JWT_PRIVATE_KEY_PATH}

# JWT Issuer
mp.jwt.verify.issuer=xpenbox-back

# JWT Expiration Time (15 minutes in seconds for production, 15 minutes for development)
%prod.mp.jwt.expiration.time=900
%dev.mp.jwt.expiration.time=900

# Min Refresh Time Before Expiration to Issue New Token (12 hours in seconds for production, 1 hour for development)
%prod.mp.jwt.refresh.min.time=43200
%dev.mp.jwt.refresh.min.time=3600

# Max Refresh Token Expiration Time (30 days in seconds for production, 1 day for development)
%prod.mp.jwt.refresh.max.time=2592000
%dev.mp.jwt.refresh.max.time=86400

# Configure Quarkus to read JWT from cookies
smallrye.jwt.token.header=Cookie
smallrye.jwt.token.cookie=access_token

# Logging Configuration
# ---------------------------------------------------------------------

# Format log output in console
quarkus.log.console.format=%d{yyyy-MM-dd HH:mm:ss} %-5p [%c{2.}] (%t) %s%e%n

# Log Level Configuration by Environment
%dev.quarkus.log.level=DEBUG
%prod.quarkus.log.level=INFO

# Log File Configuration
quarkus.log.file.enable=true
quarkus.log.file.path=${APP_PATH:.}/logs/app.log
quarkus.log.file.rotation.max-file-size=10M
quarkus.log.file.rotation.max-backup-index=5

# Log Level File Configuration by Environment
%dev.quarkus.log.file.level=DEBUG
%prod.quarkus.log.file.level=INFO

# Health Checks Configuration
# ---------------------------------------------------------------------

# Health check endpoint path
quarkus.smallrye-health.root-path=/api/rest/v1/health

# Individual health check configuration
quarkus.smallrye-health.liveness-path=/api/rest/v1/health/live
quarkus.smallrye-health.readiness-path=/api/rest/v1/health/ready
quarkus.smallrye-health.startup-path=/api/rest/v1/health/startup

# Security Configuration
# ---------------------------------------------------------------------

# Disable proactive authentication
quarkus.http.auth.proactive=false

# Permit public access to health endpoints
quarkus.http.auth.permission.health.paths=/api/rest/v1/health/*
quarkus.http.auth.permission.health.policy=permit

# API Mail Configuration
# ---------------------------------------------------------------------
# Email API URL
email.api.url=${EMAIL_API_URL:http://here-is-the-email-api-url}

# Email API Timeout Configuration (in milliseconds)
email.api.timeout=10000

# Email Token Expiration Time (in milliseconds, default to 1 hour)
email.token.expiration=3600000

# Email Token Verification URL
email.token.verification.url=${FRONTEND_URL:http://here-is-the-frontend-url}/verify-email

# Email Token Login URL
email.token.login.url=${FRONTEND_URL:http://here-is-the-frontend-url}/login
